# Система банкомата

## Описание проекта

Разработка системы банкомата с многослойной архитектурой и реализацией гексагональной архитектуры для обеспечения модульности, гибкости и удобства сопровождения. Программа предоставляет функциональность для управления счетами, проведения транзакций и просмотра истории операций.

## Ключевые особенности

### Функциональные возможности

1. **Создание счета**:
    - Регистрация новых счетов с уникальными номерами и PIN-кодами.

2. **Просмотр баланса счета**:
    - Интерактивный запрос текущего баланса.

3. **Снятие денег со счета**:
    - Проверка доступного баланса перед проведением операции.
    - Обновление состояния счета после успешного выполнения операции.

4. **Пополнение счета**:
    - Увеличение баланса счета с сохранением операции в истории.

5. **Просмотр истории операций**:
    - Доступ к истории транзакций (сумма, тип операции, дата).

6. **Режимы работы**:
    - **Пользовательский режим**:
        - Авторизация по номеру счета и PIN-коду.
        - Доступ к управлению балансом и историей операций.
    - **Администраторский режим**:
        - Авторизация по параметризуемому системному паролю.
        - Доступ к системным операциям (опционально).

### Технические особенности

1. **Архитектура**:
    - Реализация **гексагональной архитектуры**, обеспечивающей независимость слоёв приложения.
    - Поддержка опциональной **луковой архитектуры** с богатой доменной моделью.

2. **Асинхронное программирование**:
    - Повышение отзывчивости и производительности системы за счёт использования `async/await`.

3. **Dependency Injection**:
    - Использование DI для модульности и упрощения тестирования.

4. **Персистентное хранение данных**:
    - База данных **PostgreSQL**.
    - Управление миграциями с помощью **FluentMigrator**.
    - Отказ от использования ORM-библиотек.

5. **Обработка ошибок**:
    - Сообщения об ошибках при некорректных операциях (например, недостаток средств, неверный пароль).

### Консольный интерфейс

- Взаимодействие через консольные команды с поддержкой параметров и флагов.
- Ожидание следующей команды после выполнения текущей.
- Настроен с использованием [Spectre.Console](https://spectreconsole.net/).

## Тестирование

1. **Снятие денег**:
    - При достаточном балансе:
        - Проверка сохранения счета с обновленным балансом.
    - При недостаточном балансе:
        - Возврат ошибки.

2. **Пополнение счета**:
    - Проверка корректного обновления баланса счета.

3. **Изоляция тестов**:
    - Использование mock-репозиториев для тестирования бизнес-логики без зависимости от базы данных или консольного интерфейса.

## Используемые технологии

- **Язык программирования**: C#.
- **База данных**: PostgreSQL с управлением миграциями через FluentMigrator.
- **Dependency Injection**: улучшение модульности и тестируемости.
- **Асинхронное программирование**: оптимизация производительности.

## Test Cases

- Успешное снятие средств при достаточном балансе.
- Ошибка при снятии средств при недостаточном балансе.
- Корректное обновление баланса при пополнении счета.
- Тестирование парсинга команд: корректное создание объектов команд с нужными аргументами.

## Результат

- Реализованы все функциональные и нефункциональные требования.
- Программа соответствует принципам SOLID.
- Применены паттерны проектирования и многослойная архитектура.
- Полностью протестирована бизнес-логика с использованием mock-репозиториев.
- Настроен консольный интерфейс для взаимодействия с пользователями.